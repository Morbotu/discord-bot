{"version":3,"sources":["../../../../src/processor/namespaces/JSObjectNamespace.js"],"names":["STRICT_MAX_DEPTH","STRICT_MAX_WIDTH","STRICT_MAX_COLLECTION_DEPTH","STRICT_MAX_STRING","DEFAULT_MAX_DEPTH","DEFAULT_MAX_WIDTH","DEFAULT_MAX_COLLECTION_DEPTH","DEFAULT_MAX_STRING","TOLERANT_MAX_DEPTH","TOLERANT_MAX_WIDTH","TOLERANT_MAX_COLLECTION_DEPTH","TOLERANT_MAX_STRING","UNLIMITED_STRING","UNLIMITED_COLLECTION_WIDTH","JSObjectNamespace","Namespace","constructor","object","dumpConfig","obj","defaultDumpConfig","callMethod","name","args","Array","length","Object","keys","depth","parseInt","isNaN","RookInvalidMethodArguments","width","maxCollectionDepth","maxString","dumpConfigs","toLowerCase","undefined","readAttribute","readKey","key","isDefaultDumpConfig","maxDepth","maxWidth","strictDumpConfig","tolerantDumpConfig","tailorDumpConfig","String"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nimport Namespace from './Namespace';\r\n\r\nimport {RookInvalidMethodArguments} from \"../../exceptions\";\r\n\r\nexport const STRICT_MAX_DEPTH = 2;\r\nexport const STRICT_MAX_WIDTH = 10;\r\nexport const STRICT_MAX_COLLECTION_DEPTH = 1;\r\nexport const STRICT_MAX_STRING = 128;\r\n\r\nexport const DEFAULT_MAX_DEPTH = 3;\r\nexport const DEFAULT_MAX_WIDTH = 20;\r\nexport const DEFAULT_MAX_COLLECTION_DEPTH = 2;\r\nexport const DEFAULT_MAX_STRING = 512;\r\n\r\nexport const TOLERANT_MAX_DEPTH = 5;\r\nexport const TOLERANT_MAX_WIDTH = 50;\r\nexport const TOLERANT_MAX_COLLECTION_DEPTH = 4;\r\nexport const TOLERANT_MAX_STRING = 4 * 1024;\r\n\r\nexport const UNLIMITED_STRING = 64 * 1024;\r\nexport const UNLIMITED_COLLECTION_WIDTH = 100;\r\n\r\n\r\nexport default class JSObjectNamespace extends Namespace {\r\n    constructor(object, dumpConfig=null) {\r\n        super();\r\n\r\n        this.obj = object;\r\n\r\n        if (dumpConfig === null) {\r\n            this.dumpConfig = JSObjectNamespace.defaultDumpConfig();\r\n        } else {\r\n            this.dumpConfig = dumpConfig;\r\n        }\r\n    }\r\n\r\n    callMethod(name, args) {\r\n        switch (name) {\r\n            case \"type\":\r\n                return new JSObjectNamespace(typeof this.obj);\r\n            case \"size\":\r\n                if (this.obj instanceof Array) {\r\n                    return new JSObjectNamespace(this.obj.length);\r\n                } else {\r\n                    return new JSObjectNamespace(Object.keys(this.obj).length);\r\n                }\r\n            case \"depth\":\r\n                this.dumpConfig.depth = parseInt(args);\r\n                if (isNaN(this.dumpConfig.depth)) {\r\n                    throw new RookInvalidMethodArguments('depth()', args);\r\n                }\r\n                return this;\r\n            case \"width\":\r\n                this.dumpConfig.width = parseInt(args);\r\n                if (isNaN(this.dumpConfig.width)) {\r\n                    throw new RookInvalidMethodArguments('width()', args);\r\n                }\r\n                return this;\r\n            case \"collection_dump\":\r\n                this.dumpConfig.maxCollectionDepth = parseInt(args);\r\n                if (isNaN(this.dumpConfig.maxCollectionDepth)) {\r\n                    throw new RookInvalidMethodArguments('collection_dump()', args);\r\n                }\r\n                return this;\r\n            case \"string\":\r\n                this.dumpConfig.maxString = parseInt(args);\r\n                if (isNaN(this.dumpConfig.maxString)) {\r\n                    throw new RookInvalidMethodArguments('string()', args);\r\n                }\r\n                return this;\r\n            case \"limit\":\r\n                this.dumpConfig = dumpConfigs[args.toLowerCase()];\r\n                if (this.dumpConfig === undefined) {\r\n                    throw new RookInvalidMethodArguments('limit()', args);\r\n                }\r\n                return this;\r\n            default:\r\n                return super.callMethod(name, args);\r\n        }\r\n    }\r\n\r\n    readAttribute(name) {\r\n        let obj = new JSObjectNamespace(this.obj[name]);\r\n        obj.dumpConfig = this.dumpConfig;\r\n\r\n        return obj;\r\n    }\r\n\r\n    readKey(key) {\r\n        return this.readAttribute(key);\r\n    }\r\n\r\n    isDefaultDumpConfig() {\r\n        return this.dumpConfig.maxDepth === DEFAULT_MAX_DEPTH &&\r\n            this.dumpConfig.maxWidth === DEFAULT_MAX_WIDTH &&\r\n            this.dumpConfig.maxCollectionDepth === DEFAULT_MAX_COLLECTION_DEPTH &&\r\n            this.dumpConfig.maxString === DEFAULT_MAX_STRING;\r\n    }\r\n\r\n    static strictDumpConfig() {\r\n        return { maxDepth: STRICT_MAX_DEPTH,\r\n            maxWidth: STRICT_MAX_WIDTH,\r\n            maxCollectionDepth: STRICT_MAX_COLLECTION_DEPTH,\r\n            maxString: STRICT_MAX_STRING};\r\n    }\r\n\r\n    static defaultDumpConfig() {\r\n        return { maxDepth: DEFAULT_MAX_DEPTH,\r\n            maxWidth: DEFAULT_MAX_WIDTH,\r\n            maxCollectionDepth: DEFAULT_MAX_COLLECTION_DEPTH,\r\n            maxString: DEFAULT_MAX_STRING};\r\n    }\r\n\r\n    static tolerantDumpConfig() {\r\n        return { maxDepth: TOLERANT_MAX_DEPTH,\r\n            maxWidth: TOLERANT_MAX_WIDTH,\r\n            maxCollectionDepth: TOLERANT_MAX_COLLECTION_DEPTH,\r\n            maxString: TOLERANT_MAX_STRING};\r\n    }\r\n\r\n    static tailorDumpConfig(obj) {\r\n        if (typeof obj === 'string' || obj instanceof String) {\r\n            return { maxDepth: 1, maxWidth: 0, maxCollectionDepth: 0, maxString: UNLIMITED_STRING};\r\n        } else if (obj instanceof Array) {\r\n            return { maxDepth: DEFAULT_MAX_DEPTH,\r\n                maxWidth: UNLIMITED_COLLECTION_WIDTH,\r\n                maxCollectionDepth: DEFAULT_MAX_COLLECTION_DEPTH,\r\n                maxString: DEFAULT_MAX_STRING};\r\n        } else {\r\n            return JSObjectNamespace.defaultDumpConfig();\r\n        }\r\n    }\r\n}\r\n\r\nexport const dumpConfigs = {\r\n    '': JSObjectNamespace.defaultDumpConfig(),\r\n    'strict': JSObjectNamespace.strictDumpConfig(),\r\n    'default': JSObjectNamespace.defaultDumpConfig(),\r\n    'tolerant': JSObjectNamespace.tolerantDumpConfig()};\r\n"],"file":"JSObjectNamespace.js"}